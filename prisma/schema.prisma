generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [vector]
}

model User {
  id               String            @id @default(cuid())
  clerkId          String            @unique
  email            String            @unique
  name             String?
  imageUrl         String?
  createdAt        DateTime          @default(now())
  updatedAt        DateTime          @updatedAt
  learningSessions LearningSession[]

  @@map("users")
}

model LearningSession {
  id               String   @id @default(cuid())
  userId           String
  topic            String?
  topicDescription String?
  materialUrl      String?
  feedback         Json?
  status           String   @default("draft")
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
  user             User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([status])
  @@map("learning_sessions")
}

model RagChunk {
  id        String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  text      String?
  metadata  Json?
  embedding Unsupported("vector")?
  userId    String?
  createdAt DateTime               @default(now())

  @@index([userId])
  @@map("rag_chunks")
}
